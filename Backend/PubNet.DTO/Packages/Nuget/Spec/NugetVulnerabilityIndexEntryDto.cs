using System.Text.Json.Serialization;

namespace PubNet.API.DTO.Packages.Nuget.Spec;

/// <summary>
/// The following restrictions apply:
/// <list type="bullet">
///		<item>
///			<description>
///				The index must be an array of objects with between 1 and 16 items. If the server does not have any
///				vulnerability data (zero pages), then must remove the <c>VulnerabilityInfo</c> resource from the
///				<c>ServiceIndex</c>.
///			</description>
///		</item>
///		<item>
///			<description>
///				<see cref="Name"/> must be unique within the index, must be between 1 and 32 characters long, and can
///				only use the characters <c>A</c> to <c>Z</c>, <c>a</c> to <c>z</c>, <c>0</c> to <c>9</c>, <c>-</c>, or
///				<c>_</c>.
///			</description>
///		</item>
///		<item>
///			<description>
///				<see cref="Id"/> must be an absolute URL, not a relative URL.
///			</description>
///		</item>
/// </list>
/// </summary>
public class NugetVulnerabilityIndexEntryDto
{
	/// <summary>
	/// A short name for the file, used as a cache key.
	/// </summary>
	[JsonPropertyName("@name")]
	public required string Name { get; init; }

	/// <summary>
	/// The full (absolute) URL to a vulnerability data file.
	/// </summary>
	[JsonPropertyName("@id")]
	public required string Id { get; init; }

	/// <summary>
	/// An ISO 8601 string representing the date and time the file was last updated, ideally with the UTC timezone.
	/// </summary>
	[JsonPropertyName("@updated")]
	public required DateTimeOffset Updated { get; init; }

	/// <summary>
	/// A optional descriptive string.
	/// </summary>
	public string? Comment { get; init; }
}
